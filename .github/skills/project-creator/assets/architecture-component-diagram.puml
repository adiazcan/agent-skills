@startuml Component
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Component Diagram - Vista de Desarrollo

Container_Boundary(api, "Web API") {
    Component(endpoints, "Endpoints", ".NET Minimal API", "Recibe peticiones HTTP")
    Component(commands, "Commands", "Application Layer", "Operaciones de escritura (CQRS)")
    Component(queries, "Queries", "Application Layer", "Operaciones de lectura (CQRS)")
    Component(domain, "Domain", "Domain Layer", "Lógica de negocio")
    Component(repos, "Repositories", "Infrastructure", "Acceso a datos")
    Component(eventbus, "Event Bus", "Infrastructure", "Publicación de eventos")
}

ContainerDb(db, "Database", "SQL Server")
Container(cache, "Cache", "Redis + Dapr")
Container(pubsub, "Pub/Sub", "Dapr")

Rel(endpoints, commands, "Ejecuta")
Rel(endpoints, queries, "Consulta")

Rel(commands, domain, "Usa")
Rel(queries, domain, "Usa")

Rel(commands, repos, "Persiste")
Rel(queries, repos, "Lee")

Rel(commands, eventbus, "Publica eventos")

Rel(repos, db, "SQL")
Rel(repos, cache, "Dapr SDK")
Rel(eventbus, pubsub, "Dapr SDK")

@enduml
