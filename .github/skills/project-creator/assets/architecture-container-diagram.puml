@startuml C4_Container
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

title Container Diagram - Vista Física

Person(user, "Usuario")

System_Boundary(system, "API System") {
    Container(api, "Web API", ".NET 10 Minimal API", "Proporciona endpoints REST\ncon Swagger/OpenAPI")
    Container(worker, "Background Worker", ".NET BackgroundService", "Procesa tareas en background")
    
    ContainerDb(db, "Database", "SQL Server", "Almacena datos persistentes")
    Container(cache, "State Store", "Redis + Dapr", "Cache distribuido y gestión de estado")
    Container(pubsub, "Message Broker", "Redis + Dapr Pub/Sub", "Mensajería asíncrona")
}

System_Ext(frontend, "Frontend", "React + Vite")

Rel(user, frontend, "Usa", "HTTPS")
Rel(frontend, api, "Consume API", "JSON/HTTPS")

Rel(api, db, "Lee/Escribe", "EF Core")
Rel(api, cache, "Lee/Escribe estado", "Dapr SDK")
Rel(api, pubsub, "Publica eventos", "Dapr SDK")

Rel(worker, db, "Lee/Escribe", "EF Core")
Rel(worker, pubsub, "Suscribe a eventos", "Dapr SDK")
Rel(worker, cache, "Lee estado", "Dapr SDK")

@enduml
